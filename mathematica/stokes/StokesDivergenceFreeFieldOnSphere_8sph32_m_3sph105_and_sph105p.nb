(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     52470,       1416]
NotebookOptionsPosition[     50590,       1350]
NotebookOutlinePosition[     50931,       1365]
CellTagsIndexPosition[     50888,       1362]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<VectorAnalysis`\>\"", "]"}], "\n", 
 RowBox[{"SetCoordinates", "[", "Cartesian", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Element", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Ttheta", ",", " ", "Pphi"}], "}"}], ",", "Reals"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Element", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", " ", "\[Theta]"}], "}"}], ",", "Reals"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.534624171778104*^9, 3.534624183611081*^9}, {
  3.5350791757374897`*^9, 3.535079176805395*^9}, {3.535084952952785*^9, 
  3.535084953943799*^9}, {3.535393397720666*^9, 3.535393398790723*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"Cartesian", "[", 
  RowBox[{"Xx", ",", "Yy", ",", "Zz"}], "]"}]], "Output",
 CellChangeTimes->{
  3.535080995560644*^9, 3.5350849549149923`*^9, 3.5351114393399267`*^9, 
   3.535114405753579*^9, 3.535114530234746*^9, 3.535119206479746*^9, 
   3.5351194248973923`*^9, 3.535120011434413*^9, 3.535120305002462*^9, 
   3.535127445213787*^9, 3.535387903869508*^9, 3.535389327536935*^9, 
   3.5353895852679863`*^9, 3.5353899709671164`*^9, 3.53539339913351*^9, 
   3.5369289080528*^9, 3.538757126429821*^9, 3.538757170307413*^9, 
   3.538757220973681*^9, 3.5387573653745604`*^9, 3.538757798592709*^9, 
   3.538841515114757*^9, 3.543528585928689*^9, {3.543532398451065*^9, 
   3.5435324170005913`*^9}, 3.5435327018355494`*^9, 3.5435328074034357`*^9, 
   3.5435328528809443`*^9, 3.5435328922052193`*^9, 3.543532987832657*^9, 
   3.543533078093548*^9, 3.5435332272621603`*^9, 3.543533299131318*^9, 
   3.543533416418915*^9, {3.5435335416740103`*^9, 3.543533565007846*^9}, 
   3.543546712653508*^9, 3.5435467629050417`*^9, 3.543548634526816*^9, 
   3.5435487413783407`*^9, 3.543549032779969*^9, 3.543549123355036*^9},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Ttheta", "|", "Pphi"}], ")"}], "\[Element]", "Reals"}]], "Output",\

 CellChangeTimes->{
  3.535080995560644*^9, 3.5350849549149923`*^9, 3.5351114393399267`*^9, 
   3.535114405753579*^9, 3.535114530234746*^9, 3.535119206479746*^9, 
   3.5351194248973923`*^9, 3.535120011434413*^9, 3.535120305002462*^9, 
   3.535127445213787*^9, 3.535387903869508*^9, 3.535389327536935*^9, 
   3.5353895852679863`*^9, 3.5353899709671164`*^9, 3.53539339913351*^9, 
   3.5369289080528*^9, 3.538757126429821*^9, 3.538757170307413*^9, 
   3.538757220973681*^9, 3.5387573653745604`*^9, 3.538757798592709*^9, 
   3.538841515114757*^9, 3.543528585928689*^9, {3.543532398451065*^9, 
   3.5435324170005913`*^9}, 3.5435327018355494`*^9, 3.5435328074034357`*^9, 
   3.5435328528809443`*^9, 3.5435328922052193`*^9, 3.543532987832657*^9, 
   3.543533078093548*^9, 3.5435332272621603`*^9, 3.543533299131318*^9, 
   3.543533416418915*^9, {3.5435335416740103`*^9, 3.543533565007846*^9}, 
   3.543546712653508*^9, 3.5435467629050417`*^9, 3.543548634526816*^9, 
   3.5435487413783407`*^9, 3.543549032779969*^9, 3.54354912335758*^9},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"\[Phi]", "|", "\[Theta]"}], ")"}], "\[Element]", 
  "Reals"}]], "Output",
 CellChangeTimes->{
  3.535080995560644*^9, 3.5350849549149923`*^9, 3.5351114393399267`*^9, 
   3.535114405753579*^9, 3.535114530234746*^9, 3.535119206479746*^9, 
   3.5351194248973923`*^9, 3.535120011434413*^9, 3.535120305002462*^9, 
   3.535127445213787*^9, 3.535387903869508*^9, 3.535389327536935*^9, 
   3.5353895852679863`*^9, 3.5353899709671164`*^9, 3.53539339913351*^9, 
   3.5369289080528*^9, 3.538757126429821*^9, 3.538757170307413*^9, 
   3.538757220973681*^9, 3.5387573653745604`*^9, 3.538757798592709*^9, 
   3.538841515114757*^9, 3.543528585928689*^9, {3.543532398451065*^9, 
   3.5435324170005913`*^9}, 3.5435327018355494`*^9, 3.5435328074034357`*^9, 
   3.5435328528809443`*^9, 3.5435328922052193`*^9, 3.543532987832657*^9, 
   3.543533078093548*^9, 3.5435332272621603`*^9, 3.543533299131318*^9, 
   3.543533416418915*^9, {3.5435335416740103`*^9, 3.543533565007846*^9}, 
   3.543546712653508*^9, 3.5435467629050417`*^9, 3.543548634526816*^9, 
   3.5435487413783407`*^9, 3.543549032779969*^9, 3.543549123359466*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"r", ",", " ", "th", ",", " ", "ph"}], "}"}], " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"CoordinatesFromCartesian", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Xx", ",", "Yy", ",", "Zz"}], "}"}], ",", "Spherical"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.535081989409425*^9, 3.5350820065843573`*^9}, {
  3.535082326980798*^9, 3.535082329509452*^9}, {3.535082403434175*^9, 
  3.5350824563294687`*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SqrtBox[
    RowBox[{
     SuperscriptBox["Xx", "2"], "+", 
     SuperscriptBox["Yy", "2"], "+", 
     SuperscriptBox["Zz", "2"]}]], ",", 
   RowBox[{"ArcCos", "[", 
    FractionBox["Zz", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["Xx", "2"], "+", 
       SuperscriptBox["Yy", "2"], "+", 
       SuperscriptBox["Zz", "2"]}]]], "]"}], ",", 
   RowBox[{"ArcTan", "[", 
    RowBox[{"Xx", ",", "Yy"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5350823304070177`*^9, {3.5350824069685802`*^9, 3.5350824129938602`*^9}, {
   3.535082445562518*^9, 3.535082456890379*^9}, 3.535084957823132*^9, 
   3.535111439495521*^9, 3.535114405894182*^9, 3.535114530372541*^9, 
   3.5351194250394707`*^9, 3.535120011601184*^9, 3.535120305138906*^9, 
   3.5351274453737593`*^9, 3.535387904085634*^9, 3.53538932769872*^9, 
   3.5353895854400997`*^9, 3.535389971146373*^9, 3.536928908263585*^9, 
   3.5387571265469027`*^9, 3.5387571724650373`*^9, 3.538757221171912*^9, 
   3.538757365438672*^9, 3.538757798691943*^9, 3.538841515254842*^9, 
   3.543528586155157*^9, {3.543532398630158*^9, 3.543532417183053*^9}, 
   3.543532702043421*^9, 3.5435328075956917`*^9, 3.543532853064893*^9, 
   3.543532892385049*^9, 3.543532988005694*^9, 3.543533078275116*^9, 
   3.543533227503255*^9, 3.543533299331071*^9, 3.543533416608789*^9, {
   3.543533541909349*^9, 3.543533565174625*^9}, 3.54354671283875*^9, 
   3.543546763167756*^9, 3.5435486346663723`*^9, 3.543548741501768*^9, 
   3.543549033025288*^9, 3.543549123514624*^9},
 FontSize->14]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Setup", " ", "some", " ", "functions", " ", "for", " ", "Matlab", " ", 
     "equivalent", " ", "spherical", " ", 
     RowBox[{"harmonics", ".", " ", 
      RowBox[{"Note", ":", " ", 
       RowBox[{"matlab", " ", "is", " ", "off", " ", "by", " ", "sqrt", 
        RowBox[{"(", "2", ")"}], " ", "for", " ", "normalization"}]}]}]}], 
    ",", " ", 
    RowBox[{"AND", " ", "the", " ", "Ttheta", " ", 
     RowBox[{"are", " ", "[", 
      RowBox[{"0", ",", "pi"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"should", " ", 
       RowBox[{"be", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pi"}], "/", "2"}], ",", 
         RowBox[{"pi", "/", "2"}]}], "]"}]}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sphFull", "[", 
     RowBox[{"l_", ",", "m_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"ComplexExpand", "[", 
      RowBox[{"Re", "[", 
       RowBox[{
        RowBox[{"Sqrt", "[", "2", "]"}], "*", 
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"l", ",", "m", ",", "Ttheta", ",", "Pphi"}], "]"}]}], "]"}], 
      "]"}], " ", "//", "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Give", " ", "the", " ", "Spherical", " ", "Harmonic", " ", "in", " ", 
     "Cartesian", " ", 
     RowBox[{"Coordinates", ".", " ", "\[IndentingNewLine]", 
      RowBox[{"NOTE", ":", " ", 
       RowBox[{
       "MATLAB", " ", "USES", " ", "\"\<angle(...)\>\"", " ", "instead", " ", 
        "of", " ", "\"\<Arg[...]\>\""}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"sphFullCart", "[", 
     RowBox[{"l_", ",", "m_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"ComplexExpand", "[", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"Sqrt", "[", "2", "]"}], "*", 
         RowBox[{"SphericalHarmonicY", "[", 
          RowBox[{"l", ",", "m", ",", "th", ",", "ph"}], "]"}]}], "]"}], ",", 
       " ", 
       RowBox[{"TargetFunctions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Re", ",", "Im"}], "}"}]}]}], "]"}], " ", "//", 
     "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sphFullCart", "[", 
     RowBox[{"l1_", ",", "m1_", ",", "l2_", ",", " ", "m2_"}], "]"}], " ", ":=",
     " ", 
    RowBox[{
     RowBox[{"sphFullCart", "[", 
      RowBox[{"l1", ",", "m1"}], "]"}], " ", "+", " ", 
     RowBox[{"sphFullCart", "[", 
      RowBox[{"l2", ",", "m2"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sphFull", "[", 
     RowBox[{"l1_", ",", "m1_", ",", "l2_", ",", "m2_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{
     RowBox[{"ComplexExpand", "[", 
      RowBox[{"Re", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", "2", "]"}], "*", 
         RowBox[{"SphericalHarmonicY", "[", 
          RowBox[{"l1", ",", "m1", ",", "Ttheta", ",", "Pphi"}], "]"}]}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"Sqrt", "[", "2", "]"}], "*", 
         RowBox[{"SphericalHarmonicY", "[", 
          RowBox[{"l2", ",", "m2", ",", "Ttheta", ",", "Pphi"}], "]"}]}]}], 
       "]"}], "]"}], " ", "//", "Simplify"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sphLapl", "[", 
     RowBox[{"l_", ",", "m_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Laplacian", "[", 
       RowBox[{
        RowBox[{"sphFull", "[", 
         RowBox[{"l", ",", "m"}], "]"}], ",", "Spherical"}], "]"}], "/.", 
      RowBox[{"Rr", "\[Rule]", "1"}]}], "//", "Simplify"}]}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sphLapl", "[", 
     RowBox[{"l1_", ",", "m1_", ",", "l2_", ",", "m2_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Laplacian", "[", 
       RowBox[{
        RowBox[{"sphFull", "[", 
         RowBox[{"l1", ",", "m1", ",", "l2", ",", "m2"}], "]"}], ",", " ", 
        "Spherical"}], "]"}], " ", "/.", 
      RowBox[{"Rr", "\[Rule]", "1"}]}], " ", "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sphLaplCart", "[", 
     RowBox[{"l_", ",", "m_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"Laplacian", "[", 
      RowBox[{
       RowBox[{"sphFullCart", "[", 
        RowBox[{"l", ",", "m"}], "]"}], ",", "Cartesian"}], "]"}], "//", 
     "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sphLaplCart", "[", 
     RowBox[{"l1_", ",", "m1_", ",", "l2_", ",", "m2_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{
     RowBox[{"Laplacian", "[", 
      RowBox[{
       RowBox[{"sphFullCart", "[", 
        RowBox[{"l1", ",", "m1", ",", "l2", ",", "m2"}], "]"}], ",", 
       "Cartesian"}], "]"}], "//", "FullSimplify"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sphGradCart", "[", 
     RowBox[{"l_", ",", "m_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"Grad", "[", 
      RowBox[{
       RowBox[{"sphFullCart", "[", 
        RowBox[{"l", ",", "m"}], "]"}], ",", "Cartesian"}], "]"}], "//", 
     "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sphGradCart", "[", 
     RowBox[{"l1_", ",", "m1_", ",", "l2_", ",", "m2_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{
     RowBox[{"Grad", "[", 
      RowBox[{
       RowBox[{"sphFullCart", "[", 
        RowBox[{"l1", ",", "m1", ",", "l2", ",", "m2"}], "]"}], ",", 
       "Cartesian"}], "]"}], "//", "FullSimplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5346241989137487`*^9, 3.534624441023738*^9}, {
   3.534624498218348*^9, 3.534624535125416*^9}, {3.534624572454146*^9, 
   3.5346246399130573`*^9}, 3.534624700603318*^9, {3.534624959098792*^9, 
   3.534625001479898*^9}, {3.535084872446797*^9, 3.535084889693763*^9}, {
   3.535084948662257*^9, 3.535084948999237*^9}, {3.5350849796279793`*^9, 
   3.5350849957840843`*^9}, {3.53511140590466*^9, 3.5351114124657927`*^9}, {
   3.535127301899352*^9, 3.535127303062969*^9}, {3.5353882793018293`*^9, 
   3.535388321907998*^9}, {3.535389378894167*^9, 3.535389379836742*^9}, 
   3.535389569734174*^9, {3.535393228328788*^9, 3.53539324337923*^9}, {
   3.5387576310375*^9, 3.538757685534313*^9}, {3.538841412583025*^9, 
   3.538841446285684*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "U", ",", " ", "G", ",", " ", "H", ",", " ", "Qx", ",", " ", "Px", ",", " ",
    "Mm", ",", " ", "Nn", ",", " ", "Pp", ",", " ", "Ff", ",", " ", "Gg", ",",
    " ", "Hh"}], "]"}]], "Input",
 CellChangeTimes->{{3.536621121203023*^9, 3.5366211419060287`*^9}, {
  3.5366212058706827`*^9, 3.536621221900097*^9}, {3.543533176770911*^9, 
  3.543533198678668*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Let", " ", "Qx", " ", "be", " ", "the", " ", "curl", " ", "matrix", " ", 
    "which", " ", "guarantees", " ", "that", " ", "Div", 
    RowBox[{"(", 
     RowBox[{"Q", " ", "*", " ", "Grad", 
      RowBox[{"(", 
       RowBox[{"g", 
        RowBox[{"(", 
         RowBox[{"x", ",", "y", ",", "z"}], ")"}]}], ")"}]}], ")"}]}], " ", 
   "=", " ", 
   RowBox[{"0.", " ", "where", " ", "g", 
    RowBox[{"(", 
     RowBox[{"x", ",", "y", ",", "z"}], ")"}], " ", "is", " ", "ANY", " ", 
    "function", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"i", ".", "e", "."}], ",", " ", 
      RowBox[{"Spherical", " ", "Harmonics"}]}], ")"}]}]}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.543528467191184*^9, 3.54352851721841*^9}, 
   3.543528710570714*^9}],

Cell[BoxData[
 RowBox[{"Qx", " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"-", "Zz"}], ",", " ", "Yy"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"Zz", ",", " ", "0", ",", " ", 
      RowBox[{"-", "Xx"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "Yy"}], ",", " ", "Xx", ",", " ", "0"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.5366211107628736`*^9, 3.53662115599514*^9}, {
   3.536621226845435*^9, 3.536621271069695*^9}, {3.536621752192275*^9, 
   3.536621803089327*^9}, {3.54352853189083*^9, 3.5435285444746037`*^9}, {
   3.543528614512122*^9, 3.543528635984005*^9}, 3.5435286957484627`*^9, {
   3.543532358872148*^9, 3.543532361845483*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Projection", " ", "Matrix", " ", "to", " ", "Constrain", " ", "To", " ", 
    "Sphere"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Px", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", 
        RowBox[{"Xx", "^", "2"}]}], ",", " ", 
       RowBox[{
        RowBox[{"-", "Xx"}], "*", "Yy"}], ",", " ", 
       RowBox[{
        RowBox[{"-", "Xx"}], "*", "Zz"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Xx"}], "*", "Yy"}], ",", 
       RowBox[{"1", "-", 
        RowBox[{"Yy", "^", "2"}]}], ",", " ", 
       RowBox[{
        RowBox[{"-", "Yy"}], "*", "Zz"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Xx"}], "*", "Zz"}], ",", " ", 
       RowBox[{
        RowBox[{"-", "Yy"}], "*", "Zz"}], ",", " ", 
       RowBox[{"1", "-", 
        RowBox[{"Zz", "^", "2"}]}]}], "}"}]}], "}"}], " "}]}]], "Input",
 CellChangeTimes->{3.543528730874446*^9, 3.5435331480890636`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Choose", " ", "a", " ", "function", " ", "g", 
    RowBox[{"(", 
     RowBox[{"x", ",", "y", ",", "z"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"G", " ", ":=", 
    RowBox[{
     RowBox[{"8", "*", 
      RowBox[{"sphFullCart", "[", 
       RowBox[{"3", ",", "2"}], "]"}]}], " ", "-", " ", 
     RowBox[{"3", "*", 
      RowBox[{"sphFullCart", "[", 
       RowBox[{"10", ",", "5"}], "]"}]}]}]}], " ", 
   RowBox[{"(*", 
    RowBox[{"+", " ", 
     RowBox[{"sphFullCart", "[", 
      RowBox[{"20", ",", "20"}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{"Pressure", " ", ":=", " ", 
    RowBox[{"sphFullCart", "[", 
     RowBox[{"10", ",", "5"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.543532364914929*^9, 3.543532392387828*^9}, {
   3.543532429968727*^9, 3.543532497271508*^9}, {3.543532536225634*^9, 
   3.543532540624837*^9}, {3.543532617038171*^9, 3.543532665916675*^9}, {
   3.543532875023067*^9, 3.5435328775859222`*^9}, {3.543532968003084*^9, 
   3.543532976719252*^9}, 3.54353399813441*^9, {3.543534042375692*^9, 
   3.543534060324278*^9}, {3.5435347257146873`*^9, 3.543534726965478*^9}, 
   3.543534775276956*^9, {3.5435467456488333`*^9, 3.5435467488062277`*^9}, {
   3.543548624256343*^9, 3.5435486266938343`*^9}, {3.543548717380563*^9, 
   3.5435487177790813`*^9}, {3.543548960846052*^9, 3.543548980179637*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Get", " ", "our", " ", "projected", " ", "gradient", " ", "function"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"H", " ", ":=", 
   RowBox[{"Px", ".", 
    RowBox[{"Grad", "[", 
     RowBox[{"G", ",", "Cartesian"}], "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.543532672792307*^9, 3.543532686010948*^9}, 
   3.543532739163426*^9, {3.5435328606269417`*^9, 3.5435328613512583`*^9}, 
   3.54353303267293*^9, {3.543533098304139*^9, 3.5435331431508503`*^9}, 
   3.5435332626666718`*^9, 3.5435486924747*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
    "THIS", " ", "IS", " ", "THE", " ", "MANUFACTURED", " ", "SOLUTION"}], 
    " ", "*)"}],
   FontSize->18], "\[IndentingNewLine]", 
  RowBox[{"U", " ", "=", " ", 
   RowBox[{
    RowBox[{"Qx", " ", ".", " ", "H"}], " ", "//", 
    "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.536622133074719*^9, 3.5366221426877823`*^9}, {
   3.536622313850677*^9, 3.536622492623846*^9}, {3.5435286407055597`*^9, 
   3.5435286433425713`*^9}, {3.543528698529458*^9, 3.543528706181869*^9}, {
   3.54352882532657*^9, 3.543528863603722*^9}, {3.543532500608467*^9, 
   3.5435325051665993`*^9}, {3.543532767943234*^9, 3.543532793272932*^9}, {
   3.543533001267014*^9, 3.543533051388755*^9}, {3.543533122923155*^9, 
   3.5435331233383083`*^9}, {3.543533270066539*^9, 3.54353327709853*^9}, 
   3.5435335604079123`*^9, 3.543533619488699*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{"256", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Xx", "2"], "+", 
         SuperscriptBox["Yy", "2"], "+", 
         SuperscriptBox["Zz", "2"]}], ")"}], 
       RowBox[{"9", "/", "2"}]]}]], 
    RowBox[{
     SqrtBox[
      FractionBox["7", "\[Pi]"]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"512", " ", 
        SqrtBox["15"], " ", "Yy", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Xx", "2"], "+", 
           SuperscriptBox["Yy", "2"], "+", 
           SuperscriptBox["Zz", "2"]}], ")"}], "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Xx", "2"], "-", 
          SuperscriptBox["Yy", "2"], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Zz", "2"]}]}], ")"}]}], "+", 
       RowBox[{"45", " ", 
        SqrtBox["286"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Xx", "2"], "+", 
           SuperscriptBox["Yy", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]], " ", 
        SqrtBox[
         FractionBox["1", 
          RowBox[{
           SuperscriptBox["Xx", "2"], "+", 
           SuperscriptBox["Yy", "2"], "+", 
           SuperscriptBox["Zz", "2"]}]]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Yy", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Xx", "2"], "+", 
                 SuperscriptBox["Yy", "2"]}], ")"}], "3"]}], "-", 
             RowBox[{"111", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Xx", "2"], "+", 
                 SuperscriptBox["Yy", "2"]}], ")"}], "2"], " ", 
              SuperscriptBox["Zz", "2"]}], "+", 
             RowBox[{"364", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Xx", "2"], "+", 
                SuperscriptBox["Yy", "2"]}], ")"}], " ", 
              SuperscriptBox["Zz", "4"]}], "-", 
             RowBox[{"168", " ", 
              SuperscriptBox["Zz", "6"]}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"5", " ", 
             RowBox[{"ArcTan", "[", 
              RowBox[{"Xx", ",", "Yy"}], "]"}]}], "]"}]}], "+", 
          RowBox[{"Xx", " ", 
           SuperscriptBox["Zz", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"15", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Xx", "2"], "+", 
                 SuperscriptBox["Yy", "2"]}], ")"}], "2"]}], "-", 
             RowBox[{"140", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Xx", "2"], "+", 
                SuperscriptBox["Yy", "2"]}], ")"}], " ", 
              SuperscriptBox["Zz", "2"]}], "+", 
             RowBox[{"168", " ", 
              SuperscriptBox["Zz", "4"]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"5", " ", 
             RowBox[{"ArcTan", "[", 
              RowBox[{"Xx", ",", "Yy"}], "]"}]}], "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], ",", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"256", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Xx", "2"], "+", 
         SuperscriptBox["Yy", "2"], "+", 
         SuperscriptBox["Zz", "2"]}], ")"}], 
       RowBox[{"9", "/", "2"}]]}]], 
    RowBox[{
     SqrtBox[
      FractionBox["7", "\[Pi]"]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "512"}], " ", 
        SqrtBox["15"], " ", "Xx", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Xx", "2"], "-", 
          SuperscriptBox["Yy", "2"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["Zz", "2"]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Xx", "2"], "+", 
           SuperscriptBox["Yy", "2"], "+", 
           SuperscriptBox["Zz", "2"]}], ")"}], "3"]}], "-", 
       RowBox[{"45", " ", 
        SqrtBox["286"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Xx", "2"], "+", 
           SuperscriptBox["Yy", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]], " ", 
        SqrtBox[
         FractionBox["1", 
          RowBox[{
           SuperscriptBox["Xx", "2"], "+", 
           SuperscriptBox["Yy", "2"], "+", 
           SuperscriptBox["Zz", "2"]}]]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Xx", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Xx", "2"], "+", 
                 SuperscriptBox["Yy", "2"]}], ")"}], "3"]}], "-", 
             RowBox[{"111", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Xx", "2"], "+", 
                 SuperscriptBox["Yy", "2"]}], ")"}], "2"], " ", 
              SuperscriptBox["Zz", "2"]}], "+", 
             RowBox[{"364", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Xx", "2"], "+", 
                SuperscriptBox["Yy", "2"]}], ")"}], " ", 
              SuperscriptBox["Zz", "4"]}], "-", 
             RowBox[{"168", " ", 
              SuperscriptBox["Zz", "6"]}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"5", " ", 
             RowBox[{"ArcTan", "[", 
              RowBox[{"Xx", ",", "Yy"}], "]"}]}], "]"}]}], "-", 
          RowBox[{"Yy", " ", 
           SuperscriptBox["Zz", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"15", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Xx", "2"], "+", 
                 SuperscriptBox["Yy", "2"]}], ")"}], "2"]}], "-", 
             RowBox[{"140", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Xx", "2"], "+", 
                SuperscriptBox["Yy", "2"]}], ")"}], " ", 
              SuperscriptBox["Zz", "2"]}], "+", 
             RowBox[{"168", " ", 
              SuperscriptBox["Zz", "4"]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"5", " ", 
             RowBox[{"ArcTan", "[", 
              RowBox[{"Xx", ",", "Yy"}], "]"}]}], "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SqrtBox[
       FractionBox["7", "\[Pi]"]], " ", "Zz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2048", " ", 
         SqrtBox["15"], " ", "Xx", " ", "Yy", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Xx", "2"], "+", 
            SuperscriptBox["Yy", "2"], "+", 
            SuperscriptBox["Zz", "2"]}], ")"}], "3"]}], "+", 
        RowBox[{"45", " ", 
         SqrtBox["286"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Xx", "2"], "+", 
            SuperscriptBox["Yy", "2"]}], ")"}], 
          RowBox[{"5", "/", "2"}]], " ", 
         SqrtBox[
          FractionBox["1", 
           RowBox[{
            SuperscriptBox["Xx", "2"], "+", 
            SuperscriptBox["Yy", "2"], "+", 
            SuperscriptBox["Zz", "2"]}]]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"15", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Xx", "2"], "+", 
               SuperscriptBox["Yy", "2"]}], ")"}], "2"]}], "-", 
           RowBox[{"140", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Xx", "2"], "+", 
              SuperscriptBox["Yy", "2"]}], ")"}], " ", 
            SuperscriptBox["Zz", "2"]}], "+", 
           RowBox[{"168", " ", 
            SuperscriptBox["Zz", "4"]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"5", " ", 
           RowBox[{"ArcTan", "[", 
            RowBox[{"Xx", ",", "Yy"}], "]"}]}], "]"}]}]}], ")"}]}], 
     RowBox[{"256", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Xx", "2"], "+", 
         SuperscriptBox["Yy", "2"], "+", 
         SuperscriptBox["Zz", "2"]}], ")"}], 
       RowBox[{"9", "/", "2"}]]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.5435336198308163`*^9, 3.543534003274341*^9, 
  3.543534069580393*^9, 3.543534739681744*^9, 3.543534781047072*^9, 
  3.54354671306674*^9, 3.543548714871005*^9, 3.543548772341073*^9, 
  3.54354906798977*^9, 3.5435491546302757`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Prove", " ", "that", " ", "our", " ", "divergence", " ", "of", " ", 
    "this", " ", "field", " ", "is", " ", 
    RowBox[{"zero", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Div", "[", "U", "]"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.54352877341756*^9, 3.543528811687977*^9}, {
   3.543533211531921*^9, 3.5435332152878532`*^9}, 3.543533363183035*^9, {
   3.543533610800598*^9, 3.543533613648019*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.543533542512796*^9, 3.5435335654581757`*^9}, {
   3.543533606451844*^9, 3.5435336140344048`*^9}, 3.543534742758485*^9, 
   3.543534782463232*^9, 3.543546713141191*^9, 3.543548715293165*^9, 
   3.543548772566119*^9, 3.5435490682583647`*^9, 3.543549154871667*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Use", " ", "projection", " ", "matrix", " ", "to", " ", "get", " ", 
     "Laplacian", " ", "of", " ", "our", " ", "solution", " ", "in", " ", 
     "each", " ", "U"}], ",", "V", ",", 
    RowBox[{"W", " ", 
     RowBox[{"direction", "."}]}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  
  RowBox[{"(*", " ", 
   RowBox[{"Note", ":", " ", 
    RowBox[{"to", " ", "get", " ", "nth", " ", "component", " ", "of", " ", 
     RowBox[{"U", ":", " ", 
      RowBox[{"U", "[", 
       RowBox[{"[", "n", "]"}], "]"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GradRHS", " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Px", ".", 
       RowBox[{"Grad", "[", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "Cartesian"}], "]"}]}], ",", 
      RowBox[{"Px", ".", 
       RowBox[{"Grad", "[", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", "Cartesian"}], "]"}]}], 
      ",", " ", 
      RowBox[{"Px", ".", 
       RowBox[{"Grad", "[", 
        RowBox[{
         RowBox[{"U", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", " ", "Cartesian"}], "]"}]}]}], 
     "}"}]}], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"THIS", " ", "IS", " ", "A", " ", "MANUFACTURED", " ", "RHS"}], 
     " ", "*)"}],
    FontSize->18], "\[IndentingNewLine]", 
   RowBox[{"LaplRHS", " ", ":=", 
    RowBox[{"Px", ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Div", "[", 
        RowBox[{
         RowBox[{"GradRHS", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "Cartesian"}], "]"}], ",",
        " ", 
       RowBox[{"Div", "[", 
        RowBox[{
         RowBox[{"GradRHS", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", "Cartesian"}], "]"}], ",",
        " ", 
       RowBox[{"Div", "[", 
        RowBox[{
         RowBox[{"GradRHS", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", " ", "Cartesian"}], "]"}]}], 
      "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"GradP", " ", ":=", " ", 
    RowBox[{"Px", ".", 
     RowBox[{"Grad", "[", 
      RowBox[{"Pressure", ",", "Cartesian"}], "]"}], " "}]}]}]}]], "Input",
 CellChangeTimes->{{3.5435336317519093`*^9, 3.543533719276065*^9}, {
   3.543533904036437*^9, 3.543533943484353*^9}, 3.5435340971049833`*^9, {
   3.54353418906116*^9, 3.5435341933684597`*^9}, {3.5435346131642942`*^9, 
   3.543534613565263*^9}, {3.543534843961664*^9, 3.5435348954034147`*^9}, {
   3.5435350796872587`*^9, 3.543535219216556*^9}, {3.5435466834567327`*^9, 
   3.543546696022719*^9}, {3.54354871253683*^9, 3.543548713147415*^9}, {
   3.543548989457931*^9, 3.54354900478043*^9}, {3.543549104114012*^9, 
   3.5435491068800297`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHS", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "LaplRHS"}], "+", "GradP"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.5435289109223824`*^9, 3.5435289176425533`*^9}, {
   3.5435291026419783`*^9, 3.5435291239645023`*^9}, {3.54352916658924*^9, 
   3.543529185525999*^9}, 3.543533062651342*^9, {3.543533430091929*^9, 
   3.543533443874053*^9}, {3.543534668804966*^9, 3.5435347194037657`*^9}, {
   3.543534835558165*^9, 3.543534836234383*^9}, {3.54353544888687*^9, 
   3.5435354490853577`*^9}, {3.5435489873180723`*^9, 3.54354901083391*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{"256", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["Xx", "2"], "+", 
        SuperscriptBox["Yy", "2"]}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Xx", "2"], "+", 
         SuperscriptBox["Yy", "2"], "+", 
         SuperscriptBox["Zz", "2"]}], ")"}], 
       RowBox[{"11", "/", "2"}]]}]], 
    RowBox[{"3", " ", 
     SqrtBox[
      FractionBox["7", "\[Pi]"]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2048", " ", 
        SqrtBox["15"], " ", "Yy", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["Xx", "2"], "+", 
          SuperscriptBox["Yy", "2"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Xx", "2"], "+", 
           SuperscriptBox["Yy", "2"], "+", 
           SuperscriptBox["Zz", "2"]}], ")"}], "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Xx", "2"], "-", 
          SuperscriptBox["Yy", "2"], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Zz", "2"]}]}], ")"}]}], "+", 
       RowBox[{"5", " ", 
        SqrtBox["286"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Xx", "2"], "+", 
           SuperscriptBox["Yy", "2"]}], ")"}], "2"], " ", 
        SqrtBox[
         FractionBox["1", 
          RowBox[{
           SuperscriptBox["Xx", "2"], "+", 
           SuperscriptBox["Yy", "2"], "+", 
           SuperscriptBox["Zz", "2"]}]]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"330", " ", "Yy"}], "+", 
             RowBox[{"Xx", " ", "Zz"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Xx", "2"], "+", 
                 SuperscriptBox["Yy", "2"]}], ")"}], "3"]}], "-", 
             RowBox[{"111", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Xx", "2"], "+", 
                 SuperscriptBox["Yy", "2"]}], ")"}], "2"], " ", 
              SuperscriptBox["Zz", "2"]}], "+", 
             RowBox[{"364", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Xx", "2"], "+", 
                SuperscriptBox["Yy", "2"]}], ")"}], " ", 
              SuperscriptBox["Zz", "4"]}], "-", 
             RowBox[{"168", " ", 
              SuperscriptBox["Zz", "6"]}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"5", " ", 
             RowBox[{"ArcTan", "[", 
              RowBox[{"Xx", ",", "Yy"}], "]"}]}], "]"}]}], "-", 
          RowBox[{"Zz", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["Xx", "2"], " ", "Yy"}], "+", 
             SuperscriptBox["Yy", "3"], "-", 
             RowBox[{"330", " ", "Xx", " ", "Zz"}], "+", 
             RowBox[{"Yy", " ", 
              SuperscriptBox["Zz", "2"]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"15", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Xx", "2"], "+", 
                 SuperscriptBox["Yy", "2"]}], ")"}], "2"]}], "-", 
             RowBox[{"140", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Xx", "2"], "+", 
                SuperscriptBox["Yy", "2"]}], ")"}], " ", 
              SuperscriptBox["Zz", "2"]}], "+", 
             RowBox[{"168", " ", 
              SuperscriptBox["Zz", "4"]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"5", " ", 
             RowBox[{"ArcTan", "[", 
              RowBox[{"Xx", ",", "Yy"}], "]"}]}], "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], ",", 
   RowBox[{"-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"256", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["Xx", "2"], "+", 
         SuperscriptBox["Yy", "2"]}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Xx", "2"], "+", 
          SuperscriptBox["Yy", "2"], "+", 
          SuperscriptBox["Zz", "2"]}], ")"}], 
        RowBox[{"11", "/", "2"}]]}]], 
     RowBox[{"3", " ", 
      SqrtBox[
       FractionBox["7", "\[Pi]"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2048", " ", 
         SqrtBox["15"], " ", "Xx", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["Xx", "2"], "+", 
           SuperscriptBox["Yy", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Xx", "2"], "-", 
           SuperscriptBox["Yy", "2"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["Zz", "2"]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Xx", "2"], "+", 
            SuperscriptBox["Yy", "2"], "+", 
            SuperscriptBox["Zz", "2"]}], ")"}], "3"]}], "-", 
        RowBox[{"5", " ", 
         SqrtBox["286"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Xx", "2"], "+", 
            SuperscriptBox["Yy", "2"]}], ")"}], "2"], " ", 
         SqrtBox[
          FractionBox["1", 
           RowBox[{
            SuperscriptBox["Xx", "2"], "+", 
            SuperscriptBox["Yy", "2"], "+", 
            SuperscriptBox["Zz", "2"]}]]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"330", " ", "Xx"}], "-", 
               RowBox[{"Yy", " ", "Zz"}]}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Xx", "2"], "+", 
                  SuperscriptBox["Yy", "2"]}], ")"}], "3"]}], "-", 
              RowBox[{"111", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Xx", "2"], "+", 
                  SuperscriptBox["Yy", "2"]}], ")"}], "2"], " ", 
               SuperscriptBox["Zz", "2"]}], "+", 
              RowBox[{"364", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Xx", "2"], "+", 
                 SuperscriptBox["Yy", "2"]}], ")"}], " ", 
               SuperscriptBox["Zz", "4"]}], "-", 
              RowBox[{"168", " ", 
               SuperscriptBox["Zz", "6"]}]}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"5", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"Xx", ",", "Yy"}], "]"}]}], "]"}]}], "+", 
           RowBox[{"Zz", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"15", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Xx", "2"], "+", 
                  SuperscriptBox["Yy", "2"]}], ")"}], "2"]}], "-", 
              RowBox[{"140", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Xx", "2"], "+", 
                 SuperscriptBox["Yy", "2"]}], ")"}], " ", 
               SuperscriptBox["Zz", "2"]}], "+", 
              RowBox[{"168", " ", 
               SuperscriptBox["Zz", "4"]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Xx", "3"], "+", 
              RowBox[{"330", " ", "Yy", " ", "Zz"}], "+", 
              RowBox[{"Xx", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Yy", "2"], "+", 
                 SuperscriptBox["Zz", "2"]}], ")"}]}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"5", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"Xx", ",", "Yy"}], "]"}]}], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}]}], ",", 
   RowBox[{"-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"256", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["Xx", "2"], "+", 
         SuperscriptBox["Yy", "2"]}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Xx", "2"], "+", 
          SuperscriptBox["Yy", "2"], "+", 
          SuperscriptBox["Zz", "2"]}], ")"}], 
        RowBox[{"11", "/", "2"}]]}]], 
     RowBox[{"3", " ", 
      SqrtBox[
       FractionBox["7", "\[Pi]"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"8192", " ", 
         SqrtBox["15"], " ", "Xx", " ", "Yy", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["Xx", "2"], "+", 
           SuperscriptBox["Yy", "2"]}]], " ", "Zz", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Xx", "2"], "+", 
            SuperscriptBox["Yy", "2"], "+", 
            SuperscriptBox["Zz", "2"]}], ")"}], "3"]}], "+", 
        RowBox[{"5", " ", 
         SqrtBox["286"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Xx", "2"], "+", 
            SuperscriptBox["Yy", "2"]}], ")"}], "3"], " ", 
         SqrtBox[
          FractionBox["1", 
           RowBox[{
            SuperscriptBox["Xx", "2"], "+", 
            SuperscriptBox["Yy", "2"], "+", 
            SuperscriptBox["Zz", "2"]}]]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Xx", "2"], "+", 
                  SuperscriptBox["Yy", "2"]}], ")"}], "3"]}], "-", 
              RowBox[{"111", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Xx", "2"], "+", 
                  SuperscriptBox["Yy", "2"]}], ")"}], "2"], " ", 
               SuperscriptBox["Zz", "2"]}], "+", 
              RowBox[{"364", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Xx", "2"], "+", 
                 SuperscriptBox["Yy", "2"]}], ")"}], " ", 
               SuperscriptBox["Zz", "4"]}], "-", 
              RowBox[{"168", " ", 
               SuperscriptBox["Zz", "6"]}]}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"5", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"Xx", ",", "Yy"}], "]"}]}], "]"}]}], "+", 
           RowBox[{"330", " ", "Zz", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"15", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Xx", "2"], "+", 
                  SuperscriptBox["Yy", "2"]}], ")"}], "2"]}], "-", 
              RowBox[{"140", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Xx", "2"], "+", 
                 SuperscriptBox["Yy", "2"]}], ")"}], " ", 
               SuperscriptBox["Zz", "2"]}], "+", 
              RowBox[{"168", " ", 
               SuperscriptBox["Zz", "4"]}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"5", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"Xx", ",", "Yy"}], "]"}]}], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5435289137566338`*^9, 3.54352891804783*^9}, 
   3.543529125435875*^9, 3.543529186177087*^9, {3.543532400681677*^9, 
   3.543532419250177*^9}, 3.543532990874819*^9, 3.5435330796450872`*^9, 
   3.5435332294754267`*^9, 3.543533302282741*^9, {3.543533418958481*^9, 
   3.543533447767949*^9}, {3.543533543285042*^9, 3.543533566172439*^9}, 
   3.5435346451266947`*^9, {3.543534679272747*^9, 3.5435347197731943`*^9}, 
   3.543534786662871*^9, 3.543534838146093*^9, 3.543534899297996*^9, 
   3.543535090479561*^9, 3.5435351686369762`*^9, 3.5435352221389923`*^9, {
   3.543535422968732*^9, 3.543535450159616*^9}, 3.5435467207925797`*^9, 
   3.5435488617499113`*^9, 3.5435492405142612`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"TRANSLATE", " ", "SOLUTION", " ", "TO", " ", "MATLAB"}], " ", 
    "*)"}],
   FontSize->18], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"FortranForm", "[", 
   RowBox[{"U", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.543535428084538*^9, 3.5435354353309717`*^9}, {
  3.54354662585958*^9, 3.543546641282967*^9}}],

Cell["\<\
        (Sqrt(7/Pi)*(512*Sqrt(15)*Yy*(Xx**2 + Yy**2 + Zz**2)**3*(Xx**2 - \
Yy**2 + 2*Zz**2) + 
     -      45*Sqrt(286)*(Xx**2 + Yy**2)**1.5*Sqrt(1/(Xx**2 + Yy**2 + \
Zz**2))*
     -       (Yy*(3*(Xx**2 + Yy**2)**3 - 111*(Xx**2 + Yy**2)**2*Zz**2 + \
364*(Xx**2 + Yy**2)*Zz**4 - 168*Zz**6)*Cos(5*ArcTan(Xx,Yy)) + 
     -         Xx*Zz**2*(15*(Xx**2 + Yy**2)**2 - 140*(Xx**2 + Yy**2)*Zz**2 + \
168*Zz**4)*Sin(5*ArcTan(Xx,Yy)))))/(256.*(Xx**2 + Yy**2 + Zz**2)**4.5)\
\>", "Output",
 CellChangeTimes->{3.543535436931834*^9, 3.543546652047377*^9, 
  3.5435467209890423`*^9, 3.543548861889462*^9, 3.543549240698729*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"FortranForm", "[", 
   RowBox[{"U", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.543535453768361*^9, 3.543535455419977*^9}}],

Cell["\<\
        (Sqrt(7/Pi)*(-512*Sqrt(15)*Xx*(Xx**2 - Yy**2 - 2*Zz**2)*(Xx**2 + \
Yy**2 + Zz**2)**3 - 
     -      45*Sqrt(286)*(Xx**2 + Yy**2)**1.5*Sqrt(1/(Xx**2 + Yy**2 + \
Zz**2))*
     -       (Xx*(3*(Xx**2 + Yy**2)**3 - 111*(Xx**2 + Yy**2)**2*Zz**2 + \
364*(Xx**2 + Yy**2)*Zz**4 - 168*Zz**6)*Cos(5*ArcTan(Xx,Yy)) - 
     -         Yy*Zz**2*(15*(Xx**2 + Yy**2)**2 - 140*(Xx**2 + Yy**2)*Zz**2 + \
168*Zz**4)*Sin(5*ArcTan(Xx,Yy)))))/(256.*(Xx**2 + Yy**2 + Zz**2)**4.5)\
\>", "Output",
 CellChangeTimes->{3.5435354558362513`*^9, 3.543546721069889*^9, 
  3.54354886197906*^9, 3.543549240864068*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"FortranForm", "[", 
   RowBox[{"U", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.543535456659789*^9, 3.543535458288837*^9}}],

Cell["\<\
        -(Sqrt(7/Pi)*Zz*(2048*Sqrt(15)*Xx*Yy*(Xx**2 + Yy**2 + Zz**2)**3 + 
     -       45*Sqrt(286)*(Xx**2 + Yy**2)**2.5*Sqrt(1/(Xx**2 + Yy**2 + \
Zz**2))*(15*(Xx**2 + Yy**2)**2 - 140*(Xx**2 + Yy**2)*Zz**2 + \
168*Zz**4)*Sin(5*ArcTan(Xx,Yy))))/
     -  (256.*(Xx**2 + Yy**2 + Zz**2)**4.5)\
\>", "Output",
 CellChangeTimes->{3.543535458761342*^9, 3.543546721157236*^9, 
  3.543548862058487*^9, 3.543549240998282*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"RHS", " ", "IN", " ", "MATLAB"}], " ", "*)"}],
   FontSize->18], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"FortranForm", "[", 
   RowBox[{"RHS", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.543535460153253*^9, 3.543535462972031*^9}, 
   3.543546620563109*^9, {3.5435466645806417`*^9, 3.543546668048675*^9}}],

Cell["\<\
        (3*Sqrt(7/Pi)*(2048*Sqrt(15)*Yy*Sqrt(Xx**2 + Yy**2)*(Xx**2 + Yy**2 + \
Zz**2)**3*(Xx**2 - Yy**2 + 2*Zz**2) + 
     -      5*Sqrt(286)*(Xx**2 + Yy**2)**2*Sqrt(1/(Xx**2 + Yy**2 + Zz**2))*
     -       ((330*Yy + Xx*Zz)*(3*(Xx**2 + Yy**2)**3 - 111*(Xx**2 + \
Yy**2)**2*Zz**2 + 364*(Xx**2 + Yy**2)*Zz**4 - 168*Zz**6)*Cos(5*ArcTan(Xx,Yy)) \
- 
     -         Zz*(Xx**2*Yy + Yy**3 - 330*Xx*Zz + Yy*Zz**2)*(15*(Xx**2 + \
Yy**2)**2 - 140*(Xx**2 + Yy**2)*Zz**2 + 168*Zz**4)*Sin(5*ArcTan(Xx,Yy)))))/
     -  (256.*Sqrt(Xx**2 + Yy**2)*(Xx**2 + Yy**2 + Zz**2)**5.5)\
\>", "Output",
 CellChangeTimes->{3.5435354636715107`*^9, 3.5435466216468*^9, 
  3.543546673461671*^9, 3.54354672123764*^9, 3.543548862139674*^9, 
  3.543549241055591*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"FortranForm", "[", 
   RowBox[{"RHS", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.543535464997612*^9, 3.5435354714030867`*^9}}],

Cell["\<\
        (-3*Sqrt(7/Pi)*(2048*Sqrt(15)*Xx*Sqrt(Xx**2 + Yy**2)*(Xx**2 - Yy**2 - \
2*Zz**2)*(Xx**2 + Yy**2 + Zz**2)**3 - 
     -      5*Sqrt(286)*(Xx**2 + Yy**2)**2*Sqrt(1/(Xx**2 + Yy**2 + Zz**2))*
     -       (-((330*Xx - Yy*Zz)*(3*(Xx**2 + Yy**2)**3 - 111*(Xx**2 + \
Yy**2)**2*Zz**2 + 364*(Xx**2 + Yy**2)*Zz**4 - \
168*Zz**6)*Cos(5*ArcTan(Xx,Yy))) + 
     -         Zz*(15*(Xx**2 + Yy**2)**2 - 140*(Xx**2 + Yy**2)*Zz**2 + \
168*Zz**4)*(Xx**3 + 330*Yy*Zz + Xx*(Yy**2 + Zz**2))*Sin(5*ArcTan(Xx,Yy)))))/
     -  (256.*Sqrt(Xx**2 + Yy**2)*(Xx**2 + Yy**2 + Zz**2)**5.5)\
\>", "Output",
 CellChangeTimes->{{3.543535467513006*^9, 3.5435354718885612`*^9}, 
   3.543546721324724*^9, 3.543548862224807*^9, 3.543549241113035*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"FortranForm", "[", 
   RowBox[{"RHS", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.54353547304984*^9, 3.54353547937241*^9}}],

Cell["\<\
        (-3*Sqrt(7/Pi)*(8192*Sqrt(15)*Xx*Yy*Sqrt(Xx**2 + Yy**2)*Zz*(Xx**2 + \
Yy**2 + Zz**2)**3 + 
     -      5*Sqrt(286)*(Xx**2 + Yy**2)**3*Sqrt(1/(Xx**2 + Yy**2 + Zz**2))*
     -       ((3*(Xx**2 + Yy**2)**3 - 111*(Xx**2 + Yy**2)**2*Zz**2 + \
364*(Xx**2 + Yy**2)*Zz**4 - 168*Zz**6)*Cos(5*ArcTan(Xx,Yy)) + 
     -         330*Zz*(15*(Xx**2 + Yy**2)**2 - 140*(Xx**2 + Yy**2)*Zz**2 + \
168*Zz**4)*Sin(5*ArcTan(Xx,Yy)))))/(256.*Sqrt(Xx**2 + Yy**2)*(Xx**2 + Yy**2 + \
Zz**2)**5.5)\
\>", "Output",
 CellChangeTimes->{3.5435354798399277`*^9, 3.5435355994458103`*^9, 
  3.543546721404415*^9, 3.543548862306987*^9, 3.5435492412144012`*^9}]
}, Open  ]]
},
WindowSize->{1363, 996},
WindowMargins->{{12, Automatic}, {Automatic, 24}},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 678, 16, 84, "Input"],
Cell[1248, 40, 1144, 18, 29, "Output"],
Cell[2395, 60, 1164, 20, 32, "Output"],
Cell[3562, 82, 1170, 20, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4769, 107, 501, 13, 29, "Input"],
Cell[5273, 122, 1564, 33, 61, "Output"]
}, Open  ]],
Cell[6852, 158, 6282, 163, 328, "Input"],
Cell[13137, 323, 408, 8, 27, "Input"],
Cell[13548, 333, 821, 23, 27, "Input"],
Cell[14372, 358, 755, 18, 27, "Input"],
Cell[15130, 378, 1076, 33, 43, "Input"],
Cell[16209, 413, 1434, 32, 58, "Input"],
Cell[17646, 447, 579, 13, 43, "Input"],
Cell[CellGroupData[{
Cell[18250, 464, 899, 19, 49, "Input"],
Cell[19152, 485, 8956, 256, 319, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28145, 746, 524, 12, 43, "Input"],
Cell[28672, 760, 312, 4, 27, "Output"]
}, Open  ]],
Cell[28999, 767, 2814, 74, 109, "Input"],
Cell[CellGroupData[{
Cell[31838, 845, 595, 11, 27, "Input"],
Cell[32436, 858, 12381, 340, 416, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44854, 1203, 435, 11, 64, "Input"],
Cell[45292, 1216, 623, 11, 78, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45952, 1232, 220, 5, 43, "Input"],
Cell[46175, 1239, 601, 11, 78, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46813, 1255, 220, 5, 43, "Input"],
Cell[47036, 1262, 426, 8, 65, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47499, 1275, 433, 10, 64, "Input"],
Cell[47935, 1287, 744, 13, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48716, 1305, 224, 5, 43, "Input"],
Cell[48943, 1312, 728, 12, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49708, 1329, 220, 5, 43, "Input"],
Cell[49931, 1336, 643, 11, 78, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
